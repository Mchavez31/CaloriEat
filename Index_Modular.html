<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CaloriEat</title>

  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header>
  <div class="header-top-row">
    <div class="header-left">
      <h1>CaloriEat</h1>
    </div>

    <div class="menu-icon" id="menuIcon">‚ò∞</div>
    <div class="dropdown" id="menuDropdown">
      <a href="Index_Modular.html?page=dashboard" id="menuDashboard">Dashboard</a>
      <a href="Index_Modular.html?page=account" id="menuAccount">Account</a>
      <a href="Index_Modular.html?page=help" id="menuHelp">Help</a>
      <a href="Index_Modular.html?page=contact" id="menuContact">Contact</a>
      <a href="#" id="menuLogout">Logout</a>
    </div>
  </div>

  <!-- NEW clickable links row INSIDE the blue header -->
  <div class="header-links-row">
    <a class="header-link" href="set-goals.html">Set Goals</a>
    <a class="header-link" href="add-meal.html">Add Meals</a>
    <a class="header-link" href="weigh-in.html">Weigh In</a>
  </div>
</header>

  <!-- LOGIN SECTION -->
  <div class="container" id="loginSection">
    <h2>Login</h2>
    <div id="errorPopup">Username/Password does not exist</div>

    <label for="username">Username:</label>
    <input type="text" id="username" placeholder="e.g., JohnDoe">

    <label for="password">Password:</label>
    <input type="password" id="password" placeholder="Enter your password">

    <button id="loginBtn">Login</button>

    <div class="forgot-link">
      <a href="#" id="forgotLink">Forgot Username or Password?</a>
    </div>

    <div class="signup-link">
      <p>Don't have an account? <a href="#" id="signUpLink">Sign Up</a></p>
    </div>
  </div>

  <!-- ENTER KEY FIX FOR LOGIN -->
  <script>
  // Allow Enter key to submit login
  document.addEventListener('DOMContentLoaded', function() {
    const usernameInput = document.getElementById('username');
    const passwordInput = document.getElementById('password');
    const loginBtn = document.getElementById('loginBtn');
    
    // Press Enter on username -> move to password
    if (usernameInput) {
      usernameInput.addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
          event.preventDefault();
          passwordInput.focus();
        }
      });
    }
    
    // Press Enter on password -> click login
    if (passwordInput) {
      passwordInput.addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
          event.preventDefault();
          loginBtn.click();
        }
      });
    }
  });
  </script>


  <!-- RESET POPUP -->
  <div id="resetPopup" class="hidden popup-card">
    <h3>Reset Credentials</h3>
    <p>If you forgot your username or password, click the link below to reset them.</p>
    <p><a href="#" id="resetLink">Reset Username / Password</a></p>
    <button id="closeResetPopup" class="btn-close">Close</button>
  </div>

  <!-- SIGN UP / PROFILE SETUP SECTION -->
  <div class="container hidden" id="profileSection">
    <h2>Hello! Let's Set Up Your Account!</h2>

    <div id="signupError" style="
      display:none;
      background:#a10000;
      color:#fff;
      padding:10px;
      text-align:center;
      border-radius:8px;
      margin-bottom:10px;
      font-weight:bold;
      font-size:0.9rem;">
      <!-- error text goes here -->
    </div>

    <label for="setupUsername">Username:</label>
    <input type="text" id="setupUsername" placeholder="Create a username">

    <label for="setupEmail">Email:</label>
    <input type="email" id="setupEmail" placeholder="Enter your email">

    <label for="setupPassword">Password:</label>
    <input type="password" id="setupPassword" placeholder="Create a password">

    <label for="birthdateSignup">Birthdate:</label>
    <input type="date" id="birthdateSignup">

    <label for="heightFtIn">Height (ft/in, e.g. 6'1" or 5 11 or 62 for 6'2"):</label>
    <input type="text" id="heightFtIn" placeholder="6'1" or 5 11 or 62">

    <label for="weightLbs">Weight (lbs):</label>
    <input type="number" id="weightLbs" placeholder="e.g., 185" step="0.1">

    <label for="gender">Gender:</label>
    <select id="gender">
      <option value="male">Male</option>
      <option value="female">Female</option>
    </select>

    <button id="saveProfileBtn">Save Profile</button>

    <div class="forgot-link">
      <a href="#" id="backToLoginLink">Back to Login</a>
    </div>
  </div>

  <!-- HOME / APP SECTION (Goals Setting) -->
  <div class="container hidden" id="appSection">
    <h2 id="welcomeMsg"></h2>

    <!-- GOAL -->
    <h2>Set Your Goal</h2>
    <label for="goal">Diet Goal:</label>
    <select id="goal">
      <option value="maintain">Maintain Weight</option>
      <option value="lose">Lose Weight</option>
      <option value="gain">Gain Weight</option>
    </select>

    <label for="targetCalories">Target Daily Calories:</label>
    <input type="number" id="targetCalories" placeholder="e.g., 2000">
    <button id="saveGoalBtn">Save Goal</button>

    <!-- DAILY TARGETS -->
    <div class="targets-box">
      <h3>Daily Targets (Macros & Veggies)</h3>
      <div class="targets-grid">
        <div>
          <label for="proteinTarget">Protein Target (g):</label>
          <input type="number" id="proteinTarget" placeholder="150">
        </div>
        <div>
          <label for="carbsTarget">Carbs Target (g):</label>
          <input type="number" id="carbsTarget" placeholder="200">
        </div>
        <div>
          <label for="fatTarget">Fat Target (g):</label>
          <input type="number" id="fatTarget" placeholder="70">
        </div>
        <div>
          <label for="sugarTarget">Sugar Target (g):</label>
          <input type="number" id="sugarTarget" placeholder="50">
        </div>
        <div>
          <label for="veggiesTarget">Veggies Target (servings):</label>
          <input type="number" id="veggiesTarget" placeholder="5">
        </div>
      </div>
      <button id="saveTargetsBtn">Save Targets</button>
    </div>

    <!-- ADD MEAL -->
    <h2>Add Meal</h2>

    <label for="meal">Meal Name:</label>
    <input type="text" id="meal" placeholder="e.g., Chicken Salad">

    <label for="foodSearch">Search Food:</label>
    <input type="text" id="foodSearch" placeholder="Search food (e.g., Apple, Rice, Burger)">
    <ul id="foodResults"></ul>

    <label for="calories">Calories:</label>
    <input type="number" id="calories" placeholder="e.g., 350">

    <div class="inline-grid-3col">
      <div>
        <label for="protein">Protein (g):</label>
        <input type="number" id="protein" placeholder="e.g., 30">
      </div>
      <div>
        <label for="carbs">Carbs (g):</label>
        <input type="number" id="carbs" placeholder="e.g., 45">
      </div>
      <div>
        <label for="fat">Fat (g):</label>
        <input type="number" id="fat" placeholder="e.g., 10">
      </div>
    </div>

    <div class="inline-grid-2col">
      <div>
        <label for="sugar">Sugar (g):</label>
        <input type="number" id="sugar" placeholder="e.g., 5">
      </div>
      <div>
        <label for="veggies">Veggie Servings:</label>
        <input type="number" id="veggies" placeholder="e.g., 1">
      </div>
    </div>

    <button id="addMealBtn">Add Meal</button>

    <!-- WEIGH IN -->
    <div class="row-inline-2col">
      <div>
        <h3>Weigh In</h3>
        <label for="weighInLbs">Today's Weight (lbs):</label>
        <input type="number" id="weighInLbs" placeholder="e.g., 184.5" step="0.1">
        <button id="addWeighInBtn">Save Weigh In</button>
      </div>
    </div>

    <h4>Meals</h4>
    <div id="mealList"></div>
  </div>

<!-- DASHBOARD SECTION -->
<div class="container hidden" id="dashboardSection">
  <h2>Dashboard</h2>

  <!-- SUMMARY -->
  <div class="summary">
    <h3>Today's Summary</h3>
    <p id="userDisplay"></p>
    <p id="profileDisplay"></p>

    <p id="goalDisplay">Goal: Not Set</p>
    <p id="totalCalories">Total Calories: 0</p>
    <p id="remainingCalories">Remaining Calories: -</p>
    
    <!-- Average Calories Per Time Period -->
    <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #3a3a3a;">
      <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 0.5rem;">
        <span><strong>Average Calories:</strong></span>
        <select id="avgCaloriesPeriod" style="width: auto; margin: 0; padding: 0.4rem 0.6rem; font-size: 0.85rem;">
          <option value="day">Per Day</option>
          <option value="week">Per Week</option>
          <option value="month">Per Month</option>
          <option value="year">Per Year</option>
        </select>
      </div>
      <p id="avgCaloriesDisplay" style="margin-top: 0.5rem; font-size: 1.1rem; color: #8ecae6;">
        <strong>0 cal/day</strong>
      </p>
    </div>
  </div>

  <div class="rings-wrapper">
    <div class="ring-card">
      <canvas id="ringCalories" class="ringCanvas" width="100" height="100"></canvas>
      <div class="ring-label">Calories</div>
      <div class="ring-desc" id="ringCaloriesText"></div>
    </div>

    <div class="ring-card">
      <canvas id="ringProtein" class="ringCanvas" width="100" height="100"></canvas>
      <div class="ring-label">Protein</div>
      <div class="ring-desc" id="ringProteinText"></div>
    </div>

    <div class="ring-card">
      <canvas id="ringCarbs" class="ringCanvas" width="100" height="100"></canvas>
      <div class="ring-label">Carbs</div>
      <div class="ring-desc" id="ringCarbsText"></div>
    </div>

    <div class="ring-card">
      <canvas id="ringFat" class="ringCanvas" width="100" height="100"></canvas>
      <div class="ring-label">Fat</div>
      <div class="ring-desc" id="ringFatText"></div>
    </div>

    <div class="ring-card">
      <canvas id="ringSugar" class="ringCanvas" width="100" height="100"></canvas>
      <div class="ring-label">Sugar</div>
      <div class="ring-desc" id="ringSugarText"></div>
    </div>

    <div class="ring-card">
      <canvas id="ringVeggies" class="ringCanvas" width="100" height="100"></canvas>
      <div class="ring-label">Veggies</div>
      <div class="ring-desc" id="ringVeggiesText"></div>
    </div>
  </div>

  <!-- PROGRESS ANALYSIS SECTION -->
  <div class="charts-section">
    <h3>Progress Analysis</h3>
    
<!-- 1) Calorie Intake Chart -->
    <div class="chart-container" data-chart="calorie">
      <h4>Calories Per Day</h4>
      <span class="chart-hint">üí° Click on bars for details</span>
      <button class="expand-btn" title="Expand to fullscreen">‚õ∂</button>
      <canvas id="calorieChart" class="chartCanvas"></canvas>
    </div>

    <div class="pie-chart-container">
      <div class="pie-chart-header">
        <h4>Average Macros Distribution</h4>
        <div class="time-period-selector">
          <label>Period:</label>
          <select id="macrosPiePeriod" class="period-select">
            <option value="day">Day</option>
            <option value="week">Week</option>
            <option value="month">Month</option>
            <option value="year">Year</option>
          </select>
        </div>
      </div>
      <canvas id="macrosPieChart" class="pieCanvas"></canvas>
    </div>

    <div class="chart-container" data-chart="macros">
      <div class="chart-header">
        <h4>Macros & Sugar (grams)</h4>
        <div class="chart-controls">
          <button class="toggle-btn active" data-metric="protein" style="background: #1f6feb;">
            üí™ Protein
          </button>
          <button class="toggle-btn active" data-metric="carbs" style="background: #8ecae6;">
            üçû Carbs
          </button>
          <button class="toggle-btn active" data-metric="fat" style="background: #ffb703;">
            ü•ë Fat
          </button>
          <button class="toggle-btn active" data-metric="sugar" style="background: #fb5607;">
            üç¨ Sugar
          </button>
        </div>
      </div>
      
      <!-- Time Period Selector -->
      <div class="time-period-selector">
        <label for="macrosPeriod">Time Period:</label>
        <select id="macrosPeriod" class="period-select">
          <option value="overall">Overall</option>
          <option value="yearly">Yearly</option>
          <option value="monthly">Monthly</option>
          <option value="weekly">Weekly</option>
        </select>
        <button id="macrosCalendarBtn" class="calendar-btn hidden">üìÖ Select Date</button>
        <input type="date" id="macrosDatePicker" class="date-picker hidden">
      </div>
      
      <span class="chart-hint">üí° Click on lines for details</span>
      <button class="expand-btn" title="Expand to fullscreen">‚õ∂</button>
      <canvas id="macrosChart" class="interactiveChart"></canvas>
      
      <!-- Legend -->
      <div id="macrosLegend" class="chart-legend"></div>
    </div>

    <div class="pie-chart-container">
      <div class="pie-chart-header">
        <h4>Average Calories by Meal Type</h4>
        <div class="time-period-selector">
          <label>Period:</label>
          <select id="mealTypePiePeriod" class="period-select">
            <option value="day">Day</option>
            <option value="week">Week</option>
            <option value="month">Month</option>
            <option value="year">Year</option>
          </select>
        </div>
      </div>
      <canvas id="mealTypePieChart" class="pieCanvas"></canvas>
    </div>

    <div class="chart-container" data-chart="mealType">
      <div class="chart-header">
        <h4>Meal Type Breakdown Over Time</h4>
        <div class="chart-controls">
          <button class="toggle-btn active" data-metric="breakfast" style="background: #ff9800;">
            üåÖ Breakfast
          </button>
          <button class="toggle-btn active" data-metric="lunch" style="background: #ffc107;">
            ‚òÄÔ∏è Lunch
          </button>
          <button class="toggle-btn active" data-metric="dinner" style="background: #2196f3;">
            üåô Dinner
          </button>
          <button class="toggle-btn active" data-metric="snack" style="background: #9c27b0;">
            üçø Snack
          </button>
        </div>
      </div>
      
      <!-- Metric Selector -->
      <div class="time-period-selector">
        <label for="mealTypeMetric">Show:</label>
        <select id="mealTypeMetric" class="period-select">
          <option value="calories">Calories (cal)</option>
          <option value="protein">Protein (g)</option>
          <option value="carbs">Carbs (g)</option>
          <option value="fat">Fat (g)</option>
          <option value="sugar">Sugar (g)</option>
          <option value="veggies">Veggies (cal)</option>
          <option value="fruits">Fruits (cal)</option>
          <option value="grains">Grains (cal)</option>
          <option value="processedFoods">Processed Foods (cal)</option>
        </select>
      </div>

      <!-- Time Period Selector -->
      <div class="time-period-selector">
        <label for="mealTypePeriod">Time Period:</label>
        <select id="mealTypePeriod" class="period-select">
          <option value="overall">Overall</option>
          <option value="yearly">Yearly</option>
          <option value="monthly">Monthly</option>
          <option value="weekly">Weekly</option>
        </select>
        <button id="mealTypeCalendarBtn" class="calendar-btn hidden">üìÖ Select Date</button>
        <input type="date" id="mealTypeDatePicker" class="date-picker hidden">
      </div>
      
      <span class="chart-hint">üí° Click on lines for details</span>
      <button class="expand-btn" title="Expand to fullscreen">‚õ∂</button>
      <canvas id="mealTypeChart" class="interactiveChart"></canvas>
      
      <!-- Legend -->
      <div id="mealTypeLegend" class="chart-legend"></div>
    </div>

    <div class="pie-chart-container">
      <div class="pie-chart-header">
        <h4>Average Food Categories Distribution</h4>
        <div class="time-period-selector">
          <label>Period:</label>
          <select id="categoriesPiePeriod" class="period-select">
            <option value="day">Day</option>
            <option value="week">Week</option>
            <option value="month">Month</option>
            <option value="year">Year</option>
          </select>
        </div>
      </div>
      <canvas id="categoriesPieChart" class="pieCanvas"></canvas>
    </div>

    <div class="chart-container" data-chart="categories">
      <div class="chart-header">
        <h4>Food Categories (% of Diet)</h4>
        <div class="chart-controls">
          <button class="toggle-btn active" data-metric="fruits" style="background: #ff6b9d;">
            üçé Fruits
          </button>
          <button class="toggle-btn active" data-metric="veggies" style="background: #00c853;">
            ü•¶ Veggies
          </button>
          <button class="toggle-btn active" data-metric="wholeGrains" style="background: #d4a574;">
            üåæ Grains
          </button>
          <button class="toggle-btn active" data-metric="leanProteins" style="background: #1f6feb;">
            üçó Proteins
          </button>
          <button class="toggle-btn active" data-metric="processedFoods" style="background: #fb8500;">
            üçî Processed
          </button>
          <button class="toggle-btn active" data-metric="sugaryFoods" style="background: #dc2626;">
            üç≠ Sugary
          </button>
        </div>
      </div>
      
      <!-- Time Period Selector -->
      <div class="time-period-selector">
        <label for="categoriesPeriod">Time Period:</label>
        <select id="categoriesPeriod" class="period-select">
          <option value="overall">Overall</option>
          <option value="yearly">Yearly</option>
          <option value="monthly">Monthly</option>
          <option value="weekly">Weekly</option>
        </select>
        <button id="categoriesCalendarBtn" class="calendar-btn hidden">üìÖ Select Date</button>
        <input type="date" id="categoriesDatePicker" class="date-picker hidden">
      </div>
      
      <span class="chart-hint">üí° Click on lines for details</span>
      <button class="expand-btn" title="Expand to fullscreen">‚õ∂</button>
      <canvas id="veggiesChart" class="interactiveChart"></canvas>
      
      <!-- Legend -->
      <div id="categoriesLegend" class="chart-legend"></div>
    </div>

    <div class="chart-container" data-chart="weight">
      <h4>Weight Over Time</h4>
      <span class="chart-hint">üí° Click on lines for details</span>
      <button class="expand-btn" title="Expand to fullscreen">‚õ∂</button>
      <canvas id="weightChart" class="chartCanvas"></canvas>
    </div>
  </div>
</div>

  <div class="container hidden" id="accountSection">
    <h2>Your Account</h2>

    <label for="acctDisplayName">Display Name:</label>
    <input type="text" id="acctDisplayName" placeholder="Name shown in the app">

    <label for="acctEmail">Email:</label>
    <input type="email" id="acctEmail" placeholder="Email">

    <label for="acctBirthdate">Birthdate:</label>
    <input type="date" id="acctBirthdate">

    <label for="acctHeightFtIn">Height (ft/in):</label>
    <input type="text" id="acctHeightFtIn" placeholder="6'1" or 5 11 or 62">

    <label for="acctWeightLbs">Weight (lbs):</label>
    <input type="number" id="acctWeightLbs" step="0.1" placeholder="e.g., 184.5">

    <label for="acctGender">Gender:</label>
    <select id="acctGender">
      <option value="male">Male</option>
      <option value="female">Female</option>
    </select>

    <button id="saveAccountBtn">Update Profile</button>

    <button id="clearDataBtn" style="background:#8b0000; border:1px solid #aa0000;">
    Clear My Logged Data (meals / weigh-ins)
    </button>

    <p class="note">Note: Username / password changes are not supported in this demo.</p>
  </div>

  <!-- HELP SECTION -->
  <div class="container hidden" id="helpSection">
    <h2>Help Page</h2>
    <ul>
      <li><strong>Dashboard:</strong> View your daily progress with rings showing calories, protein, carbs, fat, sugar, and veggie servings. See charts tracking your calorie intake and weight over time.</li>
      <li><strong>Set Goals:</strong> Define your daily calorie target (maintain, lose, or gain weight) and set macro goals for protein, carbs, fat, sugar, and vegetable servings.</li>
      <li><strong>Add Meals:</strong> Log meals with calories and macros (including sugar). Use the food search to quickly find common foods. Edit or delete meals as needed.</li>
      <li><strong>Weigh In:</strong> Track your weight over time. Add new weigh-ins and view your weight history.</li>
      <li><strong>Account:</strong> Update your profile information including display name, email, birthdate, height, weight, and gender.</li>
      <li><strong>Navigation:</strong> Use the hamburger menu (‚ò∞) in the top-left to access all sections, or use the quick links in the blue header.</li>
    </ul>
    
    <h3>Tips</h3>
    <ul>
      <li>Set realistic goals based on your activity level and weight goals</li>
      <li>Log meals consistently for accurate tracking</li>
      <li>Weigh yourself at the same time each day for consistency</li>
      <li>The dashboard rings turn green when you exceed your targets</li>
      <li>Use the food search to quickly add common foods</li>
      <li>Monitor your sugar intake to maintain healthy eating habits</li>
    </ul>
  </div>

  <!-- CONTACT SECTION -->
  <div class="container hidden" id="contactSection">
    <h2>Contact Us</h2>
    <p>Have questions, feedback, or need support? Send us a message!</p>
    
    <label for="contactName">Name:</label>
    <input type="text" id="contactName" placeholder="Your name">

    <label for="contactEmail">Email:</label>
    <input type="email" id="contactEmail" placeholder="your.email@example.com">

    <label for="contactMessage">Message:</label>
    <textarea id="contactMessage" rows="5" placeholder="Tell us what's on your mind..."></textarea>

    <button id="sendMessageBtn">Send Message</button>
    
    <p class="note">Note: This is a demo app. Messages are not actually sent.</p>
  </div>

  <script src="app.js"></script>
</body>
</html>